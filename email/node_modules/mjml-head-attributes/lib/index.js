"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _reduce2 = _interopRequireDefault(require("lodash/reduce"));

var _omit2 = _interopRequireDefault(require("lodash/omit"));

var _forEach2 = _interopRequireDefault(require("lodash/forEach"));

var _mjmlCore = require("mjml-core");

class MjAttributes extends _mjmlCore.HeadComponent {
  handler() {
    const {
      add
    } = this.context;
    const {
      children
    } = this.props;
    (0, _forEach2.default)(children, child => {
      const {
        tagName,
        attributes,
        children
      } = child;

      if (tagName === 'mj-class') {
        add('classes', attributes.name, (0, _omit2.default)(attributes, ['name']));
        add('classesDefault', attributes.name, (0, _reduce2.default)(children, (acc, {
          tagName,
          attributes
        }) => ({ ...acc,
          [tagName]: attributes
        }), {}));
      } else {
        add('defaultAttributes', tagName, attributes);
      }
    });
  }

}

exports.default = MjAttributes;
(0, _defineProperty2.default)(MjAttributes, "componentName", 'mj-attributes');
module.exports = exports.default;